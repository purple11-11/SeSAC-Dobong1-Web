<!DOCTYPE html>
<html lang="ko">
  <%- include('include/include', { title: 'ë¡œê·¸ì¸' })%>
  <body>
    <h1>ë¡œê·¸ì¸</h1>
    <!-- 
      [ë¡œê·¸ì¸] ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ profile.ejsì—ì„œ íŠ¹ì • ìœ ì € ì •ë³´ë¥¼ ë³´ì—¬ì£¼ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— 
      userid ì •ë³´ë¥¼ valueì— ì €ì¥(POST /user/signin ìš”ì²­ì˜ ì‘ë‹µì„ ë°›ì€ í›„ ìˆ˜í–‰)í•˜ì—¬
      í¼(input)ì´ ë³´ì´ì§€ ì•Šë„ë¡ hidden ì²˜ë¦¬í•¨
    -->
    <form name="form_info" action="/user/profile" method="POST">
      <input type="hidden" name="userid" />
    </form>

    <form name="form_login">
      <label for="userid">ID</label>
      <input id="userid" type="text" name="userid" required /><br />
      <label for="password">Password</label>
      <input id="password" type="password" name="pw" required /><br />
      <button type="button" onclick="login();">Login</button>
    </form>

    <!-- TODO: href ì†ì„±ê°’ ì„¤ì •í•˜ê¸° -->
    <a href="/user/signup">Register</a>
    <a href="/">HOME</a>

    <script>
      // TODO: [Login] ë²„íŠ¼ í´ë¦­ì‹œ ì„œë²„ì— ë¡œê·¸ì¸ ìš”ì²­í•˜ê¸°
      // POST /user/signin
      function login() {
        const form = document.forms["form_login"];
        const formInfo = document.forms["form_info"];

        // ìœ íš¨ì„± ì²´í¬
        if (!form.checkValidity()) {
          // alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          form.reportValidity();
          return;
        }

        axios({
          method: "post",
          url: "/user/signin",
          data: {
            userid: form.userid.value,
            pw: form.pw.value,
          },
        }).then((res) => {
          console.log(res.data);
          const { data } = res;
          if (data) {
            // ë¡œê·¸ì¸ ì„±ê³µ
            // 1. ë¡œê·¸ì¸ ì„±ê³µ alert ë„ìš°ê¸°
            alert("ë¡œê·¸ì¸ ì„±ê³µ!ğŸ˜");
            // 2. <form name="form_login">ì˜ useridë¥¼ <input type="hidden">ì— ì „ë‹¬í•˜ê¸°
            formInfo.userid.value = form.userid.value;
            // 3. hidden input form ì œì¶œ
            formInfo.submit(); // /user/profileë¡œ POST ìš”ì²­ ë³´ë‚´ëŠ” ì¤‘
          } else {
            alert("ë¡œê·¸ì¸ ì‹¤íŒ¨!ğŸ˜¥");
            form.reset(); // inputì°½ ì´ˆê¸°í™”
          }
        });
      }
    </script>
  </body>
</html>
